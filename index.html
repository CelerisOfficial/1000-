<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>Kullanıcı Kaydetme</title>
</head>
<body>

<input type="text" id="nameInput" placeholder="İsminizi yazın" />
<button id="saveBtn">Kaydet</button>

<ul id="userList"></ul>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbxIWWlts6W6xZ-M2oI33yUlg8jzQbsxQCwWfVnif4DCDNdJW7wfsj7iYv7pKb7wWmLC4g/exec"; // Kendi URL'n ile değiştir

// Kullanıcıları GET ile çek
async function fetchUsers() {
  try {
    const res = await fetch(GAS_URL, { method: 'GET' });
    if (!res.ok) throw new Error("Sunucudan veri çekilemedi");
    const users = await res.json();
    
    const userList = document.getElementById('userList');
    userList.innerHTML = "";
    users.forEach(u => {
      let li = document.createElement('li');
      li.textContent = u.name;
      userList.appendChild(li);
    });
  } catch (e) {
    alert("Kullanıcılar yüklenirken hata: " + e.message);
  }
}

// Yeni kullanıcı ekle POST ile
async function saveUser(name) {
  try {
    if (!name) {
      alert("İsim boş olamaz");
      return;
    }
    
    const res = await fetch(GAS_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name })
    });
    
    if (!res.ok) throw new Error("Kullanıcı kaydedilemedi");
    const result = await res.json();
    
    if (result.error) {
      alert("Sunucu hatası: " + result.error);
      return;
    }
    
    alert("Kullanıcı başarıyla kaydedildi!");
    fetchUsers(); // Listeyi yenile
  } catch (e) {
    alert("Kaydetme işlemi başarısız: " + e.message);
  }
}

// Buton tıklama
document.getElementById('saveBtn').addEventListener('click', () => {
  const name = document.getElementById('nameInput').value.trim();
  saveUser(name);
});

// Sayfa açılır açılmaz kullanıcıları yükle
window.onload = fetchUsers;

</script>

</body>
</html>
