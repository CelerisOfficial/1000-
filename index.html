<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>Kullanıcı Kaydetme</title>
</head>
<body>

<input type="text" id="nameInput" placeholder="İsminizi yazın" />
<button id="saveBtn">Kaydet</button>

<ul id="userList"></ul>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbzaOqWJ7t1mHcMOl2spZoqFUHf_yAJ3j62-j2Lvx6wabuAkcDX5jcDbnPbJECN844kvzw/exec"; // Kendi URL'n ile değiştir

// Kullanıcıları GET ile çek
async function fetchUsersFromSheet() {
  try {
    let response = await fetch(GAS_URL);
    if (!response.ok) throw new Error("Sunucu hatası: " + response.status);
    let users = await response.json();
    return users;
  } catch (err) {
    console.error("Veri çekilemedi:", err);
    return [];
  }
}

// Yeni kullanıcı ekle POST ile
async function saveUser(name) {
  try {
    if (!name) {
      alert("İsim boş olamaz");
      return;
    }
    
    const res = await fetch(GAS_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name })
    });
    
    if (!res.ok) throw new Error("Kullanıcı kaydedilemedi");
    const result = await res.json();
    
    if (result.error) {
      alert("Sunucu hatası: " + result.error);
      return;
    }
    
    alert("Kullanıcı başarıyla kaydedildi!");
    fetchUsers(); // Listeyi yenile
  } catch (e) {
    alert("Kaydetme işlemi başarısız: " + e.message);
  }
}

// Buton tıklama
document.getElementById('saveBtn').addEventListener('click', () => {
  const name = document.getElementById('nameInput').value.trim();
  saveUser(name);
});

// Sayfa açılır açılmaz kullanıcıları yükle
window.onload = fetchUsers;

</script>

</body>
</html>
